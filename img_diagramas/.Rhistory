labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
sub = 2*ii*(N/part)
ind = (sub+1):(sub+N/part)
NN = length(ind)
te = (ind)*(30/NN)+30
mm = floor(te/60)
ss = floor(te - 60*mm)
places = ceiling(seq(1,length(te),by=(length(te)-1)/10))
places[1] = 1
plaquitas = c()
for(y in 1:length(places)){
i = places[y]
if(ss[i]==0 || ss[i]==59){
seg = '00'
}else{
seg=toString(ss[i])
}
plaquitas = c(plaquitas,
paste0(toString(mm[i]+4),
':',seg))
}
places[1]=0
axis(1,at=places,labels=plaquitas,las=1)
par(mar=c(4,3,2,1))
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='w',ylab='',main='Y(t,w)',
yaxt='n')
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80,type = 'l',col=arcoiris[i+1])
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80,type = 'l',col=kolor[i+1])
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1])
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
if(grabar){
dev.off()
#setwd(g_dir)
pdf(paste0('espectros4',
'.pdf'),width=8,height=2)
#'.png'),units='in',res=150,width=12,height=6)
}
dev.off()
par(mar=c(4,3,2,1))
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='w',ylab='',main='Y(t,w)',
yaxt='n')
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1])
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
par(mar=c(3,3,2,1))
par(las=2)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='w',ylab='',main='Y(t,w)',
yaxt='n')
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='w',ylab='',main='Y(t,w)',
yaxt='n',xaxt='n')
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Frecuencia (Hz)',ylab='',main='Y(t,w)',
yaxt='n',xaxt='n')
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Frecuencia (Hz)',ylab='',main='Y(t,w)',
yaxt='n',xaxt='n',mgp = c(2, 1, 0))
par(mar=c(3,3,2,1))
par(las=1)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Frecuencia (Hz)',ylab='',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
length(indd)
K = indd*(6/length(ind))
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',ylab='',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
K = indd*(6/length(indd))
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',ylab='',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(abs(fft(XX[indd]))+i*80+20,type = 'l',col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',ylab='',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',ylab='',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
axis(2,at=c(40+80*i),labels=paste0('t=',toString(i+1)),las=2)
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(2,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=4,mgp = c(0, -1, -.5))
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
if(grabar){
dev.off()
#setwd(g_dir)
pdf(paste0('espectros4',
'.pdf'),width=8,height=2)
#'.png'),units='in',res=150,width=12,height=6)
}
dev.off()
par(mar=c(3,3,2,1))
par(las=1)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',main='Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',
main='Sujeto: ---  |  Época: ---  |  Canal: ---  |  Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
if(grabar){
dev.off()
#setwd(g_dir)
pdf(paste0('espectros4',
'.pdf'),width=8,height=2)
#'.png'),units='in',res=150,width=12,height=6)
}
dev.off()
M = matrix(c(1,0,1,0,1,0,1,0,1,0))
M = t(M)
par(mar=c(4,2,2,1))
color2D.matplot(M,axes=F,
xlab='Tiempo (mm:ss)',
ylab='',
main='Sujeto: ---')
library(plotrix)
M = matrix(c(1,0,1,0,1,0,1,0,1,0))
M = t(M)
par(mar=c(4,2,2,1))
color2D.matplot(M,axes=F,
xlab='Tiempo (mm:ss)',
ylab='',
main='Sujeto: ---')
axis(2,at=c(0,1),labels=F)
axis(2,at=c(0.5),labels=c('Canal: ---'),tick=F)
axis(1,
at=(0:(length(plaquitas)-1))*(length(M)/(length(plaquitas)-1)),
labels=plaquitas,las=1)
plaquitas = c()
for(y in 1:length(places)){
i = places[y]
if(ss[i]==0 || ss[i]==59){
seg = '00'
}else{
seg=toString(ss[i])
}
plaquitas = c(plaquitas,
paste0(toString(mm[i]+4),
':',seg))
}
places[1]=0
places[1]=1
axis(1,
at=(0:(length(plaquitas)-1))*(length(M)/(length(plaquitas)-1)),
labels=plaquitas,las=1)
color2D.matplot(M,axes=F,
xlab='Tiempo (mm:ss)',
ylab='',
main='Sujeto: ---')
axis(2,at=c(0,1),labels=F)
axis(2,at=c(0.5),labels=c('Canal: ---'),tick=F)
te = ((1:N))*(5*60/N)
mm = floor(te/60)
ss = floor(te - 60*mm)
places = ceiling(seq(0,N,by=(N)/20))
places[1] = 1
plaquitas = c()
for(y in 1:length(places)){
i = places[y]
if(ss[i]==0 || ss[i]==59){
seg = '00'
}else{
seg=toString(ss[i])
}
plaquitas = c(plaquitas,
paste0(toString(mm[i]+4),
':',seg))
}
places[1]=1
axis(1,
at=(0:(length(plaquitas)-1))*(length(M)/(length(plaquitas)-1)),
labels=plaquitas,las=1)
source('~/TESIS/TESIS/img_diagramas/fragmentacion01.R')
par(mar=c(3,3,2,1))
par(las=1)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',
main='Sujeto: ---  |  Época: ---  |  Canal: ---  |  Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
for(y in 0:10){
axis(3,at=c(sub+NN/(partt*2)),
#labels=paste0('t_',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
for(y in 0:10){
d = y+1
axis(3,at=c(y*(6/length(indd))),
#labels=paste0('t_',toString(i+1)),
labels=substitute(w[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
for(y in 0:10){
d = y+1
axis(3,at=c(y*(6*length(indd))),
#labels=paste0('t_',toString(i+1)),
labels=substitute(w[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
indd
K
for(y in 0:10){
d = y+1
axis(3,at=c(y*(6/10)),
#labels=paste0('t_',toString(i+1)),
labels=substitute(w[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',
main='Sujeto: ---  |  Época: ---  |  Canal: ---  |  Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(y in 0:10){
d = y+1
axis(3,at=c(y*(6/10)),
#labels=paste0('t_',toString(i+1)),
labels=substitute(w[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
if(grabar){
dev.off()
#setwd(g_dir)
pdf(paste0('espectros4',
'.pdf'),width=10,height=2)
#'.png'),units='in',res=150,width=12,height=6)
}
dev.off()
par(mar=c(3,3,2,1))
par(las=1)
i = 0
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
K = indd*(6/length(indd))
plot(K,abs(fft(XX[indd])),col='white',
type = 'l',ylim=c(0,400),
xlab='Periodo (s)',
ylab='Amplitud (dB)',
main='Sujeto: ---  |  Época: ---  |  Canal: ---  |  Y(t,w)',
yaxt='n',mgp = c(2, 1, 0))
for(y in 0:10){
d = y+1
axis(3,at=c(y*(6/10)),
#labels=paste0('t_',toString(i+1)),
labels=substitute(w[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
for(i in 0:(partt-1)){
sub = i*(NN/partt)
indd = (sub+1):(sub+NN/partt)
XXX = XX[ind]
lines(K,abs(fft(XX[indd]))+i*80+20,type = 'l',
col=kolor[i+1],
lwd=2)
d = i+1
axis(4,at=c(40+80*i),
#labels=paste0('t=',toString(i+1)),
labels=substitute(t[d],list(d=d)),
las=1,mgp = c(0, -1, -.5))
}
source('~/TESIS/TESIS/img_diagramas/fragmentacion01.R')
source('~/TESIS/TESIS/img_diagramas/fragmentacion01.R')
