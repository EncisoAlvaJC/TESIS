cuales = c(18,19)
signif = c()
for(ch in cuales){
ch.actual = kanales$Etiqueta[ch]
Hurst.tmp = Hurst.MOR.promedio[grep(ch.actual,Hurst.MOR.promedio$Canal_var),]
signif = rbind(signif,Hurst.tmp)
}
A = ggplot(signif,aes(x=Edad,y=Hurst,
shape=Grupo))+
ylab('Hurst Exponent') + xlab('Age') +
labs(shape=NULL,color=NULL) +
facet_wrap(~Canal_var,ncol=6) +
theme_classic2() +
geom_smooth(method=lm,
mapping=aes(x=Edad,y=Hurst),
inherit.aes=F,
se=F,color='gray60') +
scale_colour_discrete(guide = FALSE) +
theme(strip.background = element_blank())+
theme(legend.position='top')+
coord_cartesian(xlim=c(59,79))+
facet_grid(Etapa~Canal_var) +
geom_point()
cuales = c(20,21)
signif = c()
for(ch in cuales){
ch.actual = kanales$Etiqueta[ch]
Hurst.tmp = Hurst.NMOR.promedio[grep(ch.actual,Hurst.NMOR.promedio$Canal_var),]
signif = rbind(signif,Hurst.tmp)
}
B = ggplot(signif,aes(x=Edad,y=Hurst,
shape=Grupo))+
ylab('Hurst Exponent') + xlab('Age') +
labs(shape=NULL,color=NULL) +
facet_wrap(~Canal_var,ncol=6) +
theme_classic2() +
geom_smooth(method=lm,
mapping=aes(x=Edad,y=Hurst),
inherit.aes=F,
se=F,color='gray60') +
scale_colour_discrete(guide = FALSE) +
theme(strip.background = element_blank())+
theme(legend.position='top')+
coord_cartesian(xlim=c(59,79))+
facet_grid(Etapa~Canal_var) +
geom_point()
ggarrange(A,B,ncol=1,nrow=2,labels='AUTO',common.legend=TRUE)
ggarrange(A,labels=NULL)
# Significativos
cuales = c(18)
signif = c()
for(ch in cuales){
ch.actual = kanales$Etiqueta[ch]
Hurst.tmp = Hurst.MOR.promedio[grep(ch.actual,Hurst.MOR.promedio$Canal_var),]
signif = rbind(signif,Hurst.tmp)
}
A = ggplot(signif,aes(x=Edad,y=Hurst,
shape=Grupo))+
ylab('Hurst Exponent') + xlab('Age') +
labs(shape=NULL,color=NULL) +
facet_wrap(~Canal_var,ncol=6) +
theme_classic2() +
geom_smooth(method=lm,
mapping=aes(x=Edad,y=Hurst),
inherit.aes=F,
se=F,color='gray60') +
scale_colour_discrete(guide = FALSE) +
theme(strip.background = element_blank())+
theme(legend.position='top')+
coord_cartesian(xlim=c(59,79))+
facet_grid(Etapa~Canal_var) +
geom_point()
ggarrange(A,labels=NULL)
ggsave(filename='/Fig_age_hurst.png',path=dir_graf,
device='png',units='cm',width=4,height=4,dpi=400,scale=2)
# Significativos
cuales = c(18,19)
signif = c()
for(ch in cuales){
ch.actual = kanales$Etiqueta[ch]
Hurst.tmp = Hurst.MOR.promedio[grep(ch.actual,Hurst.MOR.promedio$Canal_var),]
signif = rbind(signif,Hurst.tmp)
}
A = ggplot(signif,aes(x=Edad,y=Hurst,
shape=Grupo))+
ylab('Hurst Exponent') + xlab('Age') +
labs(shape=NULL,color=NULL) +
facet_wrap(~Canal_var,ncol=6) +
theme_classic2() +
geom_smooth(method=lm,
mapping=aes(x=Edad,y=Hurst),
inherit.aes=F,
se=F,color='gray60') +
scale_colour_discrete(guide = FALSE) +
theme(strip.background = element_blank())+
theme(legend.position='top')+
coord_cartesian(xlim=c(59,79))+
facet_grid(Etapa~Canal_var) +
geom_point()
cuales = c(20,21)
signif = c()
for(ch in cuales){
ch.actual = kanales$Etiqueta[ch]
Hurst.tmp = Hurst.NMOR.promedio[grep(ch.actual,Hurst.NMOR.promedio$Canal_var),]
signif = rbind(signif,Hurst.tmp)
}
B = ggplot(signif,aes(x=Edad,y=Hurst,
shape=Grupo))+
ylab('Hurst Exponent') + xlab('Age') +
labs(shape=NULL,color=NULL) +
facet_wrap(~Canal_var,ncol=6) +
theme_classic2() +
geom_smooth(method=lm,
mapping=aes(x=Edad,y=Hurst),
inherit.aes=F,
se=F,color='gray60') +
scale_colour_discrete(guide = FALSE) +
theme(strip.background = element_blank())+
theme(legend.position='top')+
coord_cartesian(xlim=c(59,79))+
facet_grid(Etapa~Canal_var) +
geom_point()
ggarrange(A,B,ncol=1,nrow=2,labels='AUTO',common.legend=TRUE)
ggsave(filename='/Fig02_edad_hurst.png',path=dir_graf,
device='png',units='cm',width=7,height=7,dpi=400,scale=2)
x = rnorm(100)
write.table(x)
write.table(x,file = 'algo.txt')
??loess
source('C:/Users/EQUIPO 1/Desktop/julio/TESIS_no/articulo_dfa/scripts/graf_hurst10_corrcov.R')
source('C:/Users/EQUIPO 1/Desktop/julio/TESIS_no/articulo_dfa/scripts/graf_hurst10_corrcov.R')
View(promedios.MOR)
promedios_un = dcast(promedios,Canal_var~Hurst)
??dcast
require(reshape2)
promedios_un = dcast(promedios,Canal_var~Hurst)
View(promedios_un)
promedios_un = dcast(promedios,Hurst~Canal_var)
promedios_un = dcast(promedios,Canal_var~Hurst)
promedios_un = dcast(promedios,Hurst~Canal_var)
promedios_un = dcast(promedios,Canal_var~Hurst)
promedios_un = dcast(promedios,Sujeto_n~Canal_var)
promedios_un = dcast(promedios,Grupo~Canal_var)
View(promedios)
promedios_un = dcast(promedios,Sujeto~Canal_var)
promedios_un = dcast(promedios,Sujeto+Grupo~Canal_var)
View(promedios_un)
promedios_un = dcast(promedios,Sujeto+Grupo~Canal_var,value.var = Hurst)
promedios_un = dcast(promedios,Grupo~Canal_var,value.var = Hurst)
promedios$Canal_var = factor(promedios$Canal_var,
lables=kanales$Etiqueta)
promedios$Canal_var = factor(promedios$Canal_var,
labels=kanales$Etiqueta)
promedios_un = dcast(promedios.MOR,Grupo~Canal_var,value.var = Hurst)
promedios_un = dcast(promedios.MOR,Grupo~Canal_var)
source('C:/Users/EQUIPO 1/Desktop/julio/TESIS_no/articulo_dfa/scripts/graf_hurst10_corrcov.R')
View(promedios.todo)
View(Hurst.todo)
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var)
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var = Hurst)
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var = 'Hurst')
View(Hurst_un)
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var =Hurst)
Hurst_un = dcast(Hurst.todo,Sujeto_n+MORn~Canal_var,value.var =Hurst)
Hurst_un = dcast(Hurst.todo,Sujeto_n+MORn~Canal_var,value.var ='Hurst')
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var ='Hurst')
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var ='Hurst',
fun.aggregate = 'mean')
Hurst_un = dcast(Hurst.todo,Sujeto_n~Canal_var,value.var ='Hurst',
fun.aggregate = mean)
Hurst_un = dcast(Hurst.todo,MORn,Sujeto_n~Canal_var,value.var ='Hurst',
fun.aggregate = mean)
Hurst_un = dcast(Hurst.todo,MORn+Sujeto_n~Canal_var,value.var ='Hurst',
fun.aggregate = mean)
Hurst_un = dcast(Hurst.todo,Canal_var+Sujeto_n~MORn,value.var ='Hurst',
fun.aggregate = mean)
Hurst_un = dcast(Hurst.todo,Sujeto_n+Canal_var~MORn,value.var ='Hurst',
fun.aggregate = mean)
Hurst_un = dcast(Hurst.todo,MORn+Sujeto_n~Canal_var,value.var ='Hurst',
fun.aggregate = mean)
source('C:/Users/EQUIPO 1/Desktop/julio/TESIS/articulo_dfa/scripts/graf_hurst10_anova.R')
# nuevo: anova de medidas repetidas
big.summary = c()
ch = 1
ch.actual = kanales$Etiqueta[ch]
print(ch.actual)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.MOR[grep(ch.actual,Hurst.MOR$Canal),]
tmp.m = promedios.MOR[grep(ch.actual,promedios.MOR$Canal),]
aov   = aov(Hurst ~ (Grupo) + (MORn) +(Grupo:MORn),
data=tmp)
k = summary(aov)
k = k[[1]]
print(k)
View(tmp)
plot(k)
plot(aov)
View(promedios.MOR)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
#geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
#              color='grey40') +
geom_point()
print(p)
p = ggplot(tmp,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
#geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
#              color='grey40') +
geom_point()
print(p)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.MOR[grep(ch.actual,Hurst.MOR$Canal),]
#tmp.m = promedios.MOR[grep(ch.actual,promedios.MOR$Canal),]
tmp.m = summarySE(tmp,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
View(tmp.m)
p = ggplot(tmp,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
#geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
#              color='grey40') +
geom_point()
print(p)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
#geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
#              color='grey40') +
geom_point()
print(p)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
#coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
color='grey40') +
geom_point()
print(p)
promedios2.MOR = summarySE(Hurst.MOR,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
promedios2.MOR = summarySE(Hurst.MOR,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
min(promedios2.MOR$Hurst- promedios2.MOR$sd)
max(promedios2.MOR$Hurst+ promedios2.MOR$sd)
for(ch in 1:n.canales){
ch.actual = kanales$Etiqueta[ch]
print(ch.actual)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.MOR[grep(ch.actual,Hurst.MOR$Canal),]
#tmp.m = promedios.MOR[grep(ch.actual,promedios.MOR$Canal),]
tmp.m = summarySE(tmp,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
aov   = aov(Hurst ~ (Grupo) + (MORn) +(Grupo:MORn),
data=tmp)
k = summary(aov)
k = k[[1]]
print(k)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.95,1.75))+
geom_line(aes(group=Grupo))+
geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
color='grey40') +
geom_point()
print(p)
#ggsave(path=dir_graf,device='png',units='cm',
#       width=8,height=4,dpi=400,scale=2,
#       file=paste0(ch.actual,'.png'))
qs  = summarySE(data=tmp,groupvars=c('Grupo','MORn'),
measurevar='Hurst')
qs2 = unlist(t(qs))
qs2 = as.list((qs2))
qs2 = unlist(t(qs2))
big.summary = rbind(big.summary,qs2)
View(k)
invisible(readline(prompt="Presion [enter] para continuar"))
}
promedios2.MOR = summarySE(Hurst.MOR,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
min(promedios2.MOR$Hurst- promedios2.MOR$sd)
max(promedios2.MOR$Hurst+ promedios2.MOR$sd)
View(promedios2.MOR)
promedios2.MOR = summarySE(Hurst.MOR,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn','Canal_var'))
min(promedios2.MOR$Hurst- promedios2.MOR$sd)
max(promedios2.MOR$Hurst+ promedios2.MOR$sd)
for(ch in 1:n.canales){
ch.actual = kanales$Etiqueta[ch]
print(ch.actual)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.MOR[grep(ch.actual,Hurst.MOR$Canal),]
#tmp.m = promedios.MOR[grep(ch.actual,promedios.MOR$Canal),]
tmp.m = summarySE(tmp,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
aov   = aov(Hurst ~ (Grupo) + (MORn) +(Grupo:MORn),
data=tmp)
k = summary(aov)
k = k[[1]]
print(k)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,2.25))+
geom_line(aes(group=Grupo))+
geom_errorbar(aes(ymin=Hurst-sd,ymax=Hurst+sd),width=.1,
color='grey40') +
geom_point()
print(p)
ggsave(path=dir_graf,device='png',units='cm',
width=8,height=4,dpi=400,scale=2,
file=paste0('anova_etapasMOR_',ch.actual,'.png'))
qs  = summarySE(data=tmp,groupvars=c('Grupo','MORn'),
measurevar='Hurst')
qs2 = unlist(t(qs))
qs2 = as.list((qs2))
qs2 = unlist(t(qs2))
big.summary = rbind(big.summary,qs2)
View(k)
invisible(readline(prompt="Presion [enter] para continuar"))
}
# nuevo: anova de medidas repetidas
big.summary = c()
promedios2.MOR = summarySE(Hurst.MOR,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn','Canal_var'))
min(promedios2.MOR$Hurst- promedios2.MOR$sd)
max(promedios2.MOR$Hurst+ promedios2.MOR$sd)
for(ch in 1:n.canales){
ch.actual = kanales$Etiqueta[ch]
print(ch.actual)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.MOR[grep(ch.actual,Hurst.MOR$Canal),]
#tmp.m = promedios.MOR[grep(ch.actual,promedios.MOR$Canal),]
tmp.m = summarySE(tmp,na.rm=T,measurevar='Hurst',
groupvars=c('Grupo','MORn'))
aov   = aov(Hurst ~ (Grupo) + (MORn) +(Grupo:MORn),
data=tmp)
k = summary(aov)
k = k[[1]]
print(k)
p = ggplot(tmp.m,aes(x=MORn,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,2.25))+
geom_line(aes(group=Grupo))+
geom_errorbar(aes(ymin=Hurst-sd,ymax=Hurst+sd),width=.1,
color='grey40') +
geom_point()
print(p)
ggsave(path=dir_graf,device='png',units='cm',
width=8,height=4,dpi=400,scale=2,
file=paste0('anova_etapasMOR_',ch.actual,'.png'))
qs  = summarySE(data=tmp,groupvars=c('Grupo','MORn'),
measurevar='Hurst')
qs2 = unlist(t(qs))
qs2 = as.list((qs2))
qs2 = unlist(t(qs2))
big.summary = rbind(big.summary,qs2)
View(k)
invisible(readline(prompt="Presion [enter] para continuar"))
}
View(big.summary)
qs
install.packages(c("BH", "crypto", "devtools", "knitr", "lemon", "lubridate", "openssl", "rlang", "stringr", "viridisLite", "XML"))
install.packages(c("DBI", "httpuv", "lubridate", "openssl", "pillar", "RcppArmadillo", "rmarkdown", "tidyselect", "yaml"))
require('ggpubr')
require('scales')
###########################################################
setwd('C:/Users/EQUIPO 1/Desktop/julio/Tesis_respaldo/TESIS/img_mas_ejemplos')
grabar = T
set.seed(2018)
le1 = 100000
le2 = 1000
le1 = length(gg)
tt = 1:le1
gg = 1/(le1+1)
gg = c(rev(gg),1,gg)
le1 = length(gg)
plot(gg,type='l')
set.seed(2018)
le1 = 100000
le2 = 1000
ee = rnorm(le2 + 2*le1 + 1)
tt = 1:le1
gg = 1/(tt+1)
gg = c(rev(gg),1,gg)
le1 = length(gg)
plot(gg,type='l')
plot(log(gg),type='l')
pn = rep(0,le2)
for(i in 1:le2){
pn[i] = sum(gg*ee[1:le1+ i-1])
}
plot(ee[1:le2],type='l')
plot(pn[1:le2],type='l')
plot(pn,type='l')
m = rbind(pn,tt)
View(m)
m[1,2]
m[1,1]
m[2,1]
m = as.data.frame(t(m))
colnames(m) = c('pin','te')
m$te = m$te/500
ggplot(m,aes(x=te,y='pin')) +
xlab('Tiempo')+ylab('Medición')+
theme_bw() +
geom_line()
ggplot(m,aes(x=te,y=pin)) +
xlab('Tiempo')+ylab('Medición')+
theme_bw() +
geom_line()
source('C:/Users/EQUIPO 1/Desktop/julio/tesis_respaldo/TESIS/img_mas_ejemplos/ruido_rosa02.R')
plot(pn,type='l')
tt = 1:le2
m = rbind(pn,tt)
m = as.data.frame(t(m))
colnames(m) = c('pin','te')
m$te = m$te/500
ggplot(m,aes(x=te,y=pin)) +
xlab('Tiempo')+ylab('Medición')+
theme_bw() +
geom_line()
ggplot(m,aes(x=te,y=pin)) +
xlab('t')+ylab('X(t)')+
theme_bw() +
geom_line()
ggplot(m,aes(x=te,y=pin)) +
xlab('t')+ylab('X(t)')+
theme_bw() +
theme(panel.background = element_rect(fill = 'transparent',colour = NA),
plot.background = element_rect(fill = 'transparent',colour = NA))+
scale_x_continuous(expand=c(0,0))+
geom_line()
ggplot(m,aes(x=te,y=pin)) +
xlab('t')+ylab('X(t)')+
theme_bw() +
theme(panel.background = element_rect(fill = 'transparent',colour = NA),
plot.background = element_rect(fill = 'transparent',colour = NA))+
scale_x_continuous(expand=c(0,0))+
geom_line(color='pink')
ggplot(m,aes(x=te,y=pin)) +
xlab('t')+ylab('X(t)')+
theme_bw() +
theme(panel.background = element_rect(fill = 'transparent',colour = NA),
plot.background = element_rect(fill = 'transparent',colour = NA))+
scale_x_continuous(expand=c(0,0))+
geom_line(color='purple')
# grabar
ggsave(file=paste0('ruido_rosa.pdf'),#width=3,height=2,
bg='transparent',unit='cm')
ggplot(m,aes(x=te,y=pin)) +
xlab('Tiempo : t')+ylab('Proceso : X(t)')+
theme_bw() +
theme(panel.background = element_rect(fill = 'transparent',colour = NA),
plot.background = element_rect(fill = 'transparent',colour = NA))+
scale_x_continuous(expand=c(0,0))+
geom_line(color='purple')
# grabar
ggsave(file=paste0('ruido_rosa.pdf'),#width=3,height=2,
bg='transparent',unit='cm')
,
# grabar
ggsave(file=paste0('ruido_rosa.pdf'),#width=3,height=2,
bg='transparent',unit='cm')
require('ggpubr')
require('scales')
###########################################################
setwd('C:/Users/EQUIPO 1/Desktop/julio/Tesis_respaldo/TESIS/img_mas_ejemplos')
grabar = T
set.seed(2018)
le1 = 100000
le2 = 1000
ee = rnorm(le2 + 2*le1 + 1)
tt = 1:le1
gg = 2/(tt**2+1)
gg = c(rev(gg),1,gg)
le1 = length(gg)
pn = rep(0,le2)
for(i in 1:le2){
pn[i] = sum(gg*ee[1:le1+ i-1])
}
plot(ee[1:le2],type='l')
plot(pn,type='l')
tt = 1:le2
m = rbind(pn,tt)
m = as.data.frame(t(m))
colnames(m) = c('pin','te')
m$te = m$te/500
ggplot(m,aes(x=te,y=pin)) +
xlab('Tiempo : t')+ylab('Proceso : X(t)')+
theme_bw() +
theme(panel.background = element_rect(fill = 'transparent',colour = NA),
plot.background = element_rect(fill = 'transparent',colour = NA))+
scale_x_continuous(expand=c(0,0))+
geom_line(color='purple')
# grabar
ggsave(file=paste0('ruido_rosa.pdf'),#width=3,height=2,
bg='transparent',unit='cm')
require(fractal)
stationarity(m$pin)
