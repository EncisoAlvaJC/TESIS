###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
raw = as.data.frame(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR$Grupo              = factor(Hurst.MOR$Grupo,
labels=c('CTRL','PMCI'))
Hurst.MOR.promedio           = as.data.frame(Hurst.MOR.promedio)
Hurst.MOR.promedio$Canal_var = factor(Hurst.MOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR.promedio$Grupo     = factor(Hurst.MOR.promedio$Grupo,
labels=c('CTRL','PMCI'))
###############################################################################
###############################################################################
kanales  = read_excel(paste0(dir_info,'/info_intercanales.xlsx'),
sheet='Alfabetico')
if(orden_stam){
kanales  = read_excel(paste0(dir_info,'/info_intercanales.xlsx'),
sheet='Stam')
}
n.canales    = length(kanales$Etiqueta)
canales.arch = kanales$Nombre_archivo
###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
raw = as.data.frame(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR$Grupo              = factor(Hurst.MOR$Grupo,
labels=c('CTRL','PMCI'))
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
View(Hurst.MOR)
###############################################################################
###############################################################################
kanales  = read_excel(paste0(dir_info,'/info_intercanales.xlsx'),
sheet='Alfabetico')
if(orden_stam){
kanales  = read_excel(paste0(dir_info,'/info_intercanales.xlsx'),
sheet='Stam')
}
n.canales    = length(kanales$Etiqueta)
canales.arch = kanales$Nombre_archivo
canales
kanales
###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
View(raw)
raw = as.data.frame(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
raw = as.data.frame(raw)
View(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR$Grupo              = factor(Hurst.MOR$Grupo,
labels=c('CTL','MCI'))
Hurst.MOR.promedio           = as.data.frame(Hurst.MOR.promedio)
Hurst.MOR.promedio$Canal_var = factor(Hurst.MOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR.promedio$Grupo     = factor(Hurst.MOR.promedio$Grupo,
labels=c('CTRL','PMCI'))
Hurst.MOR.promedio$Sujeto_n = info$Nombre[Hurst.MOR.promedio$Sujeto]
###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
raw = as.data.frame(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR$Grupo              = factor(Hurst.MOR$Grupo,
labels=c('CTL','MCI'))
Hurst.MOR.promedio           = as.data.frame(Hurst.MOR.promedio)
Hurst.MOR.promedio$Canal_var = factor(Hurst.MOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR.promedio$Grupo     = factor(Hurst.MOR.promedio$Grupo,
labels=c('CTL','MCI'))
Hurst.MOR.promedio$Sujeto_n = info$Nombre[Hurst.MOR.promedio$Sujeto]
promedios.MOR               = summarySE(Hurst.MOR.promedio,na.rm=T,
measurevar='Hurst',
groupvars=c('Grupo','Canal_var'))
###############################################################################
# lo mismo para NMOR
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi_pre')
raw = as.data.frame(raw)
Hurst.NMOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.NMOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.NMOR$Canal_var = as.numeric(Hurst.NMOR$Canal_var)
Hurst.NMOR$Sujeto_n  = factor(Hurst.NMOR$Sujeto,labels = info$Nombre)
Hurst.NMOR$Etapa     = rep(0,length(Hurst.NMOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.NMOR$Hurst     = log(Hurst.NMOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.NMOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.NMOR[grep(info$Nombre[suj],Hurst.NMOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.NMOR.promedio = rbind(Hurst.NMOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.NMOR$Canal_var          = factor(Hurst.NMOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR$Grupo              = factor(Hurst.NMOR$Grupo,
labels=c('CTL','MCI'))
Hurst.NMOR.promedio           = as.data.frame(Hurst.NMOR.promedio)
Hurst.NMOR.promedio$Canal_var = factor(Hurst.NMOR.promedio$Canal_var,
labels=kanales$Etiqueta)
View(Hurst.NMOR.promedio)
###############################################################################
# lo mismo para NMOR
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi_pre')
raw = as.data.frame(raw)
Hurst.NMOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.NMOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.NMOR$Canal_var = as.numeric(Hurst.NMOR$Canal_var)
Hurst.NMOR$Sujeto_n  = factor(Hurst.NMOR$Sujeto,labels = info$Nombre)
Hurst.NMOR$Etapa     = rep(0,length(Hurst.NMOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
###############################################################################
# lo mismo para NMOR
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi_pre')
raw = as.data.frame(raw)
Hurst.NMOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.NMOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.NMOR$Canal_var = as.numeric(Hurst.NMOR$Canal_var)
Hurst.NMOR$Sujeto_n  = factor(Hurst.NMOR$Sujeto,labels = info$Nombre)
Hurst.NMOR$Etapa     = rep(0,length(Hurst.NMOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
View(Hurst.MOR)
###############################################################################
# lo mismo para NMOR
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi_pre')
raw = as.data.frame(raw)
Hurst.NMOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.NMOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.NMOR$Canal_var = as.numeric(Hurst.NMOR$Canal_var)
Hurst.NMOR$Sujeto_n  = factor(Hurst.NMOR$Sujeto,labels = info$Nombre)
Hurst.NMOR$Etapa     = rep(0,length(Hurst.NMOR$Sujeto))
Hurst.NMOR = Hurst.NMOR[!is.na(Hurst.NMOR$Hurst),]
Hurst.NMOR = Hurst.NMOR[Hurst.NMOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.NMOR$Hurst     = log(Hurst.NMOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.NMOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.NMOR[grep(info$Nombre[suj],Hurst.NMOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.NMOR.promedio = rbind(Hurst.NMOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.NMOR$Canal_var          = factor(Hurst.NMOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR$Grupo              = factor(Hurst.NMOR$Grupo,
labels=c('CTL','MCI'))
Hurst.NMOR.promedio           = as.data.frame(Hurst.NMOR.promedio)
Hurst.NMOR.promedio$Canal_var = factor(Hurst.NMOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR.promedio$Grupo     = factor(Hurst.NMOR.promedio$Grupo,
labels=c('CTL','MCI'))
# problemas con etiquetas
Hurst.NMOR$Canal_var          = factor(Hurst.NMOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR$Grupo              = factor(Hurst.NMOR$Grupo,
labels=c('CTL','MCI'))
Hurst.NMOR.promedio           = as.data.frame(Hurst.NMOR.promedio)
Hurst.NMOR.promedio$Canal_var = factor(Hurst.NMOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR.promedio$Grupo     = factor(Hurst.MOR.promedio$Grupo,
labels=c('CTL','MCI'))
###############################################################################
# cargar los datos
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi')
raw = as.data.frame(raw)
Hurst.MOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.MOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi',
'Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.MOR$Canal_var = as.numeric(Hurst.MOR$Canal_var)
Hurst.MOR$Sujeto_n  = factor(Hurst.MOR$Sujeto,labels = info$Nombre)
Hurst.MOR$Etapa     = rep(1,length(Hurst.MOR$Sujeto))
Hurst.MOR = Hurst.MOR[!is.na(Hurst.MOR$Hurst),]
Hurst.MOR = Hurst.MOR[Hurst.MOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.MOR$Hurst     = log(Hurst.MOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.MOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.MOR[grep(info$Nombre[suj],Hurst.MOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.MOR.promedio = rbind(Hurst.MOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.MOR$Canal_var          = factor(Hurst.MOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR$Grupo              = factor(Hurst.MOR$Grupo,
labels=c('CTL','MCI'))
Hurst.MOR.promedio           = as.data.frame(Hurst.MOR.promedio)
Hurst.MOR.promedio$Canal_var = factor(Hurst.MOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.MOR.promedio$Grupo     = factor(Hurst.MOR.promedio$Grupo,
labels=c('CTL','MCI'))
Hurst.MOR.promedio$Sujeto_n = info$Nombre[Hurst.MOR.promedio$Sujeto]
promedios.MOR               = summarySE(Hurst.MOR.promedio,na.rm=T,
measurevar='Hurst',
groupvars=c('Grupo','Canal_var'))
###############################################################################
# lo mismo para NMOR
raw = read_excel(paste0(dir_res_pre,'/dfa_asdataframe.xlsx'),
sheet='multi_pre')
raw = as.data.frame(raw)
Hurst.NMOR           = melt(raw,id=c('Sujeto','Grupo','Edad',
'MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa'))
colnames(Hurst.NMOR) = c('Sujeto','Grupo','Edad','MMSE','Neuropsi','Escol',
'MORn','Epoca','Etapa','Canal_var','Hurst')
Hurst.NMOR$Canal_var = as.numeric(Hurst.NMOR$Canal_var)
Hurst.NMOR$Sujeto_n  = factor(Hurst.NMOR$Sujeto,labels = info$Nombre)
Hurst.NMOR$Etapa     = rep(0,length(Hurst.NMOR$Sujeto))
Hurst.NMOR = Hurst.NMOR[!is.na(Hurst.NMOR$Hurst),]
Hurst.NMOR = Hurst.NMOR[Hurst.NMOR$Grupo>-1,]
sujetos = setdiff(unique(Hurst.MOR$Sujeto),11)
if(usar.log){
Hurst.NMOR$Hurst     = log(Hurst.NMOR$Hurst)
Hurst.promedio$Hurst = log(Hurst.promedio$Hurst)
}
Hurst.NMOR.promedio = c()
for(suj in sujetos){
tmp       = Hurst.NMOR[grep(info$Nombre[suj],Hurst.NMOR$Sujeto_n),]
promedios = aggregate(tmp,by=list(tmp$Canal_var),mean)
Hurst.NMOR.promedio = rbind(Hurst.NMOR.promedio,promedios)
}
# problemas con etiquetas
Hurst.NMOR$Canal_var          = factor(Hurst.NMOR$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR$Grupo              = factor(Hurst.NMOR$Grupo,
labels=c('CTL','MCI'))
Hurst.NMOR.promedio           = as.data.frame(Hurst.NMOR.promedio)
Hurst.NMOR.promedio$Canal_var = factor(Hurst.NMOR.promedio$Canal_var,
labels=kanales$Etiqueta)
Hurst.NMOR.promedio$Grupo     = factor(Hurst.NMOR.promedio$Grupo,
labels=c('CTL','MCI'))
Hurst.NMOR.promedio$Sujeto_n = info$Nombre[Hurst.NMOR.promedio$Sujeto]
promedios.NMOR               = summarySE(Hurst.NMOR.promedio,na.rm=T,
measurevar='Hurst',
groupvars=c('Grupo','Canal_var'))
# combinacion
Hurst.MOR$Etapa  = rep('REM',length(Hurst.MOR$Etapa))
Hurst.NMOR$Etapa = rep('NREM',length(Hurst.NMOR$Etapa))
Hurst.todo       = rbind(Hurst.MOR,Hurst.NMOR)
Hurst.MOR.promedio$Etapa  = rep('REM',length(Hurst.MOR.promedio$Etapa))
Hurst.NMOR.promedio$Etapa = rep('NREM',length(Hurst.NMOR.promedio$Etapa))
Hurst.todo.promedio       = rbind(Hurst.MOR.promedio,Hurst.NMOR.promedio)
promedios.MOR$Etapa  = rep('REM',length(promedios.MOR$Grupo))
promedios.NMOR$Etapa = rep('NREM',length(promedios.NMOR$Grupo))
promedios.todo       = rbind(promedios.MOR,promedios.NMOR)
big.summary = c()
for(ch in 1:n.canales){
ch.actual = kanales$Etiqueta[ch]
print(ch.actual)
#tmp   = Hurst.todo.promedio[grep(ch.actual,Hurst.todo.promedio$Canal),]
tmp   = Hurst.todo[grep(ch.actual,Hurst.todo$Canal),]
tmp.m = promedios.todo[grep(ch.actual,promedios.todo$Canal),]
aov   = aov(Hurst ~ (Grupo) + (Etapa) +(Grupo:Etapa),
data=tmp)
k = summary(aov)
k = k[[1]]
print(k)
View(k)
invisible(readline(prompt="Presion [enter] para continuar"))
B = ezANOVA(data=tmp,dv=Hurst,wid=Sujeto_n,
within=.(Etapa),between=.(Grupo),
within_full = .(MORn,Etapa),
observed=.(Etapa,Grupo,MORn),
detailed=T,
white.adjust = T,
reverse_diff = T,
type=2)
print(B)
B = B[[1]]
View(B)
invisible(readline(prompt="Presion [enter] para continuar"))
aa = dcast(tmp,Sujeto~MORn,value.var = 'Hurst',fun.aggregate = mean)
bb = as.matrix(aa[,2:11])
mlmfit = lm(bb~1)
M = mauchly.test(mlmfit, X = ~1)
print(M)
#M = M[1]
k = t(c(M$statistic,M$p.value))
View(k)
C = ezPlot(data=tmp,dv=Hurst,wid=Sujeto_n,
x=.(Etapa),
within=.(Etapa),between=.(Grupo),
within_full = .(MORn,Etapa),
#observed=.(Etapa,Grupo,MORn),
#observed=.(Etapa,Grupo,MORn),
#detailed=T,
#white.adjust = T,
reverse_diff = T) +
theme_classic2()
print(C)
invisible(readline(prompt="Presion [enter] para continuar"))
p = ggplot(tmp.m,aes(x=Etapa,y=Hurst,linetype=Grupo))+
theme_classic2() +
labs(linetype=ch.actual)+
coord_cartesian(ylim=c(0.3,1.75))+
geom_line(aes(group=Grupo))+
geom_errorbar(aes(ymin=Hurst-se,ymax=Hurst+se),width=.1,
color='grey40') +
geom_point()
print(p)
qs  = summarySE(data=tmp,groupvars=c('Grupo','Etapa'),
measurevar='Hurst')
qs2 = unlist(t(qs))
qs2 = as.list((qs2))
qs2 = unlist(t(qs2))
big.summary = rbind(big.summary,qs2)
#View(k)
invisible(readline(prompt="Presion [enter] para continuar"))
}
min(promedios.todo$Hurst- promedios.todo$sd)
max(promedios.todo$Hurst+ promedios.todo$sd)
View(big.summary)
require('tuneR')
# para que lo aleatorio sea repetible
set.seed(2018)
a = noise(kind=c('power'),alpha = 1,duration = 2,samp.rate = 500,
xunit='time')
# power se interpreta como 'ruido tipo f**(-power)'
a = noise(kind=c('power'),alpha = 1,duration = 2,samp.rate = 500,
xunit='time')
pn = a@left
# toma solo los datos
pin = a@left
plot(pin,type='l')
# eso es todo
plot(pin,type='l', main='Ruido rosa')
# power se interpreta como 'ruido tipo f**(-power)'
# aqui van 2 segundos a 500 Hz
# el xunit es la unidad (unidades de tiempo / puntos)
a = noise(kind=c('power'),alpha = 0,duration = 2,samp.rate = 500,
xunit='time')
# toma solo los datos
pin = a@left
# eso es todo
plot(pin,type='l', main='Ruido rosa')
1
# la libreria tuneR es para procesamiento de audio, creo
require('tuneR')
# para que lo aleatorio sea repetible
set.seed(2018)
# power se interpreta como 'ruido tipo f**(-power)'
# aqui van 2 segundos a 500 Hz
# el xunit es la unidad (unidades de tiempo / puntos)
a = noise(kind=c('power'),alpha = 1,duration = 2,samp.rate = 500,
xunit='time')
# toma solo los datos
pin = a@left
# eso es todo
plot(pin,type='l', main='Ruido rosa')
setwd("C:/Users/EQUIPO 1/Desktop/julio/tesis_respaldo/TESIS/img_mas_ejemplos")
